name: Bilibili 首页净化 (终极速度版)
desc: "极致优化加载速度，通过并行处理和精简解密链实现秒开。"
category: Rewrite

mitm:
  hostnames:
    - app.bilibili.com
    # 移除了 config 域名，减少不必要的解密开销

rewrites:
  # 1. 静态拒绝掉所有已知的广告和非核心接口（不经过脚本，0延迟）
  - match: ^https:\/\/app\.bilibili\.com\/x\/v2\/feed\/index\/add
    type: reject
  - match: ^https:\/\/app\.bilibili\.com\/x\/v2\/feed\/index\/ad
    type: reject
  - match: ^https:\/\/app\.bilibili\.com\/x\/v2\/splash
    type: reject
  # 拦截这个接口能显著加快启动速度
  - match: ^https:\/\/app\.bilibili\.com\/x\/v2\/check\/manager
    type: reject

scripts:
  # 2. 首页去直播：仅在首页刷新时运行，且限制最大处理时长
  - name: Bili_Home_Fast
    type: http-response
    match: ^https:\/\/app\.bilibili\.com\/x\/v2\/feed\/index\?
    script_url: https://raw.githubusercontent.com/ddgksf2013/Scripts/master/bilibili_diy.js
    requires_body: true
    timeout: 2  # 极限压低到2秒，确保即使脚本卡顿，首页也能迅速显示

  # 3. 空降助手：针对性匹配视频详情页
  - name: Bili_AirDrop
    type: http-response
    match: ^https:\/\/app\.bilibili\.com\/x\/v2\/view\?
    script_url: https://raw.githubusercontent.com/ddgksf2013/Scripts/master/bilibili_diy.js
    requires_body: true
    timeout: 2
